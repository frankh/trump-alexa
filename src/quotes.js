var QUOTES = [
    {
        "quote": "An 'extremely credible source' has called my office and told me that Barack Obama's birth certificate is a fraud",
        "tags": ['obama', 'stupid'],
    },
    {
        "quote": "In many respects, you know, they honor President Obama. He's the founder of ISIS. He's the founder of ISIS. He's the founder. He founded ISIS.",
        "tags": ['obama', 'terrorists', 'stupid'],
    },
    {
        "quote": "If she gets to pick her judges, nothing you can do, folks. Although, the Second Amendment people, maybe there is, I don't know.",
        "tags": ['hillary', 'scary'],
    },
    {
        "quote": "The people of Crimea, from what I've heard, would rather be with Russia than where they were",
        "tags": ['russia'],
    },
    {
        "quote": "Russia, if you're listening, I hope you're able to find the 30,000 emails that are missing",
        "tags": ['russia', 'hillary'],
    },
    {
        "quote": "Justice Ginsburg of the U.S. Supreme Court has embarrassed all by making very dumb political statements about me. Her mind is shot - resign!",
        "tags": ['law'],
    },
    {
        "quote": "Today, Iraq is Harvard for terrorism.",
        "tags": ['terrorists', 'iraq'],
    },
    {
        "quote": "Saddam was a bad guy — really bad guy. But you know what he did well? He killed terrorists. He did that so good",
        "tags": ['iraq', 'terrorists', 'stupid'],
    },
    {
        "quote": "That could be a Mexican plane up there — they're getting ready to attack",
        "tags": ['mexico', 'stupid'],
    },
    {
        "quote": "Appreciate the congrats for being right on radical Islamic terrorism, I don't want congrats, I want toughness & vigilance. We must be smart!",
        "tags": ['terrorists', 'smart'],
    },
    {
        "quote": "I was the one that really broke the glass ceiling on behalf of women, more than anybody in the construction industry",
        "tags": ['women', 'business'],
    },
    {
        "quote": "Pregnancy is a wonderful thing for the woman, it’s a wonderful thing for the husband, it’s certainly an inconvenience for a business.",
        "tags": ['women', 'business'],
    },
    {
        "quote": "My whole life is about winning. I don't lose often. I almost never lose.",
        "tags": ['trump'],
    },
    {
        "quote": "You know the funny thing? I don't get along with rich people.",
        "tags": ['trump'],
    },
    {
        "quote": "I have an attention span that's as long as it has to be.",
        "tags": ['trump'],
    },
    {
        "quote": "Bing bing, bong bong bong, bing bing.",
        "tags": ['stupid'],
    },
    {
        "quote": "No, I meant [Obama is] the founder of ISIS, I do. He was the most valuable player. I give him the most valuable player award. I give her, too, by the way, Hillary Clinton.",
        "tags": ['obama', 'terrorists', 'hillary'],
    },
    {
        "quote": "Do you mind if I sit back a little? Because your breath is very bad.",
        "tags": ['trump'],
    },
    {
        "quote": "Why can’t we use nuclear weapons?",
        "tags": ['stupid', 'scary'],
    },
    {
        "quote": "I think I've made a lot of sacrifices. I work very, very hard. I've created thousands and thousands of jobs, tens of thousands of jobs, built great structures. I've had tremendous success. I think I've done a lot.",
        "tags": ['trump', 'business'],
    },
    {
        "quote": "[Putin] is not going into Ukraine, OK, just so you understand. He’s not gonna go into Ukraine, all right? You can mark it down. You can put it down.",
        "tags": ['russia'],
    },
    {
        "quote": "I was gonna hit one guy in particular, a very little guy. I was gonna hit this guy so hard his head would spin and he wouldn’t know what the hell happened",
        "tags": ['trump'],
    },
    {
        "quote": "I’ve been treated very unfairly by this judge. Now, this judge is of Mexican heritage. I'm building a wall, OK?",
        "tags": ['law', 'mexico', 'wall'],
    },
    {
        "quote": "I could stand in the middle of Fifth Avenue and shoot somebody, and I wouldn't lose any voters",
        "tags": ['trump'],
    },
    {
        "quote": "I love the poorly educated.",
        "tags": ['trump'],
    },
    {
        "quote": "I've had a beautiful, I've had a flawless campaign. You'll be writing books about this campaign.",
        "tags": ['trump'],
    },
    {
        "quote": "He’s a war hero because he was captured. I like people that weren’t captured.",
        "tags": ['stupid', 'war'],
    },
    {
        "quote": "You know what I hate? There's a guy totally disruptive, throwing punches, we're not allowed punch back anymore. ... I'd like to punch him in the face, I'll tell ya.",
        "tags": ['violence'],
    },
    {
        "quote": "If you see somebody getting ready to throw a tomato, knock the crap out of them, would you? Seriously. ",
        "tags": ['violence'],
    },
    {
        "quote": "There were people that were cheering on the other side of New Jersey, where you have large Arab populations. They were cheering as the World Trade Center came down.",
        "tags": ['terrorists', 'stupid'],
    },
    {
        "quote": "You could see there was blood coming out of her eyes. Blood coming out of her wherever.",
        "tags": ['women'],
    },
    {
        "quote": "I've said if Ivanka weren't my daughter, perhaps I'd be dating her.",
        "tags": ['women', 'scary', 'trump'],
    },
    {
        "quote": "You know, it really doesn`t matter what [the media] write as long as you`ve got a young and beautiful piece of ass.",
        "tags": ['women'],
    },
    {
        "quote": "If Hillary Clinton were a man, I don't think she would get 5% of the vote. And the beautiful thing is women don't like her",
        "tags": ['hillary', 'women'],
    },
    {
        "quote": "When Mexico sends its people, they're not sending their best. They're sending people that have lots of problems...they're bringing drugs, they're bringing crime. They're rapists.",
        "tags": ['mexico'],
    },
    {
        "quote": "Happy Cinco de Mayo! The best taco bowls are made in Trump Tower Grill. I love Hispanics!",
        "tags": ['mexico', 'stupid', 'minorities'],
    },
    {
        "quote": "We're gonna have businesses that used to be in New Hampshire, that are now in Mexico, come back to New Hampshire, and you can tell them to go fuck themselves.",
        "tags": ['mexico'],
    },
    {
        "quote": "I'd like to use really foul language. I won't do it. I was going to say they're really full of shit, but I won't say that.",
        "tags": ['trump', 'stupid'],
    },
    {
        "quote": "The LGBT community, the gay community, the lesbian community — they are so much in favor of what I’ve been saying over the last three or four days.",
        "tags": ['minorities'],
    },
    {
        "quote": "Can you imagine that, the face of our next president? I mean, she's a woman, and I'm not supposed to say bad things, but really, folks, come on. Are we serious?",
        "tags": ['hillary', 'women'],
    },
    {
        "quote": "I think the only difference between me and the other candidates is that I'm more honest and my women are more beautiful",
        "tags": ['trump', 'women'],
    },
    {
        "quote": "The beauty of me is that I'm very rich.",
        "tags": ['trump'],
    },
    {
        "quote": "I like kids. I mean, I won’t do anything to take care of them. I’ll supply funds, and she’ll take care of the kids.",
        "tags": ['women', 'stupid'],
    },
    {
        "quote": "I have a great relationship with the blacks.",
        "tags": ['minorities'],
    },
    {
        "quote": "If Hillary Clinton can't satisfy her husband what makes her think she can satisfy America.",
        "tags": ['hillary', 'women'],
    },
    {
        "quote": "I will be the greatest jobs president that God ever created.",
        "tags": ['business', 'trump', 'stupid'],
    },
    {
        "quote": "I don’t think I’ve made mistakes. Every time somebody said I made a mistake, they do the polls and my numbers go up, so I guess I haven't made any mistakes.",
        "tags": ['trump', 'stupid'],
    },
]

QUOTES = QUOTES.concat([
    {
        "quote": "All of the women on The Apprentice flirted with me - consciously or unconsciously. That's to be expected.",
        "tags": ['women', 'the Apprentice'],
    },
    {
        "quote": "What separates the winners from the losers is how a person reacts to each new twist of fate.",
        "tags": ['inspiration'],
    },
    {
        "quote": "Sometimes your best investments are the ones you don't make.",
        "tags": ['inspiration'],
    },
    {
        "quote": "In the end, you're measured not by how much you undertake but by what you finally accomplish.",
        "tags": ['inspiration'],
    },
    {
        "quote": "You have to think anyway, so why not think big?",
        "tags": ['inspiration'],
    },
    {
        "quote": "If you're interested in 'balancing' work and pleasure, stop trying to balance them. Instead make your work more pleasurable.",
        "tags": ['inspiration'],
    },
    {
        "quote": "I try to learn from the past, but I plan for the future by focusing exclusively on the present. That's were the fun is.",
        "tags": ['inspiration'],
    },
    {
        "quote": "Anyone who thinks my story is anywhere near over is sadly mistaken.",
        "tags": ['trump'],
    },
])

var TAG_ALIASES = {
    'trump': ['himself', 'the president'],
    'obama': ['barack obama', 'barack', 'politics'],
    'stupid': ['dumb', 'silly', 'idiotic', 'crazy'],
    'scary': ['crazy', 'horrible'],
    'business': ['money', 'jobs'],
    'hillary': ['hillary clinton', 'politics'],
    'women': ['woman', 'girls', 'female'],
    'minorities': ['hispanics', 'black'],
    'mexico': ['mexicans'],
    'violence': ['fighting', 'aggression'],
    'terrorists': ['isis', 'al qaeda', 'daesh', 'osama', 'bin laden'],
    'russia': ['putin', 'vladimir', 'ukraine', 'crimea', 'politics'],
    'war': [],
    'law': ['supreme court', 'justice'],
    'wall': [],
    'iraq': [],
    'inspiration': ['advice', 'guidance', 'knowledge', 'life'],
}

function resolve_aliases(tag) {
    tag = tag.toLowerCase();
    var tags = [];
    for( var canonical_tag in TAG_ALIASES ) {
        if( TAG_ALIASES[canonical_tag].indexOf(tag) >= 0 || canonical_tag == tag ) {
            tags.push(tag);
        }
    }
    return tags;
}

var Quotes = {
    getQuote: function() {
        var i = Math.floor(Math.random() * QUOTES.length);
        var randomQuote = QUOTES[i];
        return randomQuote["quote"];
    },
    getTaggedQuote: function(tag) {
        var tags = resolve_aliases(tag);
        var potential_quotes = []

        for (var i = 0, len = QUOTES.length; i < len; i++) {
            var quote = QUOTES[i];
            var matching_tags = quote.tags.filter(function(n) {
                return tags.indexOf(n) >= 0;
            });

            if( matching_tags.length > 0 ) {
                potential_quotes.push(quote);
            }
        }
        console.log("tagged quotes for " + tag + ", resolved to " + tags + ", potential_quotes: " + potential_quotes.length);

        if( potential_quotes.length == 0 ) {
            return "I don't know about that";
        }

        var i = Math.floor(Math.random() * potential_quotes.length);
        var randomQuote = potential_quotes[i];
        return randomQuote["quote"];

    }
};

module.exports = Quotes;